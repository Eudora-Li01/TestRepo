# Copyright (c) Microsoft Corporation.
# Licensed under the MIT license.

trigger: none

pr: none

parameters:
  - name: TargetBranch
    displayName: Target branch for ACTS Repo
    type: string
    default: origin/main
  
  - name: TargetTag
    displayName: Target tag for ACTS Repo
    type: string
    default: v1.0.0

resources:
  repositories:
  - repository: TestRepo 
    type: github
    endpoint: GitHubBranchTagsTest
    name: Eudora-Li01/TestRepo
    ref: refs/heads/main
    branches:
      include:
        - main
        - test

jobs:
- job: UpdateAndPush
  displayName: 'Update file and push to other branch'
  pool:
    vmImage: 'ubuntu-latest'

  steps:
  - checkout: self
    persistCredentials: true
    clean: true
    fetchDepth: 1

  - script: |
      git fetch --prune --tags
      git branch -r
      git checkout ${{ parameters.TargetBranch }}
      current_branch=$(git rev-parse --abbrev-ref HEAD)
      echo "Current branch is: $current_branch"
    displayName: 'Switch to target branch'

  - script: |
      git checkout ${{ parameters.TargetTag }}
      current_tag=$(git describe --tags --abbrev=0)
      echo "Current tag is: $current_tag"
    displayName: 'Switch to target tag'
